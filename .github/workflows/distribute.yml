name: Distribute

on:
  workflow_dispatch:
    inputs:
      group:
        description: 'Die zu aktualisierende Gruppe. Per default werden "ALL (alle Workflows)" aktualisiert'
        type: choice
        required: true
        default: ALL
        options:
          - ALL
          - errorcodes
          - mslib
          - proxy
          - restclient
          - simple
          - standard
          - zap
          - test

jobs:
  errorcodes:
    if: ${{ github.event.inputs.group == 'errorcodes' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: md-error-codes, branch: main, group: errorcodes, workflows: "../check, build" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  mslib:
    if: ${{ github.event.inputs.group == 'mslib' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mslib-aws, branch: develop, group: mslib, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mslib-rest, branch: develop, group: mslib, workflows: "../check, build, ../encoding, postBuild" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  proxy:
    if: ${{ github.event.inputs.group == 'proxy' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mcbscore-authorities-information-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_md, deployment_prod, deployment_prod_km, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-appcheck-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_md, deployment_prod, deployment_prod_km, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-billingaccount-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-businesstransaction-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_md, deployment_prod, deployment_prod_km, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-commondata-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_md, deployment_prod, deployment_prod_km, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-contentprovider-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_md, deployment_prod, deployment_prod_km, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-cuba-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-customerchange-proxy, branch: develop, group: proxy, workflows: "../check, deployment, build, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-customerproduct-proxy, branch: develop, group: proxy, workflows: "../check, deployment, build, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-customerproduct-v3-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_md, deployment_prod, deployment_prod_km, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-customer-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-elasticupdate-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-find-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-healthcheck-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_md, deployment_dev, deployment_dev_md, deployment_git, deployment_git_md, deployment_prod, deployment_prod_md, ../encoding, postBuild" }
          - { name: mcbscore-invoice-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-mark-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-mandel-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-oidc-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_fm, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_fm, deployment_git_fm_extern, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_fm, deployment_prod_fm_extern, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-rating-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-user-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-zap-contract-service-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-zap-fee-service-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-zap-invoice-service-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-zap-mark-service-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-zap-network-service-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
          - { name: mcbscore-zap-party-service-proxy, branch: develop, group: proxy, workflows: "../check, build, deployment, deployment_b2b, deployment_b2b_km, deployment_b2b_md, deployment_dev, deployment_dev_km, deployment_dev_md, deployment_git, deployment_git_km, deployment_git_km_extern, deployment_git_md, deployment_git_md_extern, deployment_prod, deployment_prod_km, deployment_prod_km_extern, deployment_prod_md, deployment_prod_md_extern, ../encoding, postBuild" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  restclient:
    if: ${{ github.event.inputs.group == 'restclient' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mcbscore-analyserservice-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-billingaccount-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-businesstransaction-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-contentprovider-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-contractservice-resttemplate, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-contractservice-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-cuba-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-customer-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-customerchange-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-customerproduct-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-documents-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-invoiceservice-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-ms-user-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-notes-feign-client, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-notes-webclient, branch: main, group: restclient, workflows: "../check, build, ../encoding" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  simple:
    if: ${{ github.event.inputs.group == 'simple' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mcbs-logging, branch: develop, group: simple, workflows: "../check, build" }
          - { name: mcbscore-billing-data-importer, branch: main, group: simple, workflows: "../encoding" }
          - { name: mcbscore-billing-performance-monitor, branch: main, group: simple, workflows: "../encoding" }
          - { name: mcbscore-gatling-compare, branch: main, group: simple, workflows: "../encoding" }
          - { name: mcbscore-yaml-transform-plugin, branch: develop, group: simple, workflows: "../check, build, ../encoding" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  standard:
    if: ${{ github.event.inputs.group == 'standard' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mcbscore-billing-prototype-ca, branch: develop, group: standard, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-bot, branch: develop, group: standard, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-changelog-editor, branch: develop, group: standard, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-compare-cp-contract-ui, branch: develop, group: standard, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-contentprovider-ui, branch: develop, group: standard, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-customerproduct-and-contract-service-ui, branch: develop, group: standard, workflows: "../check, build, ../encoding" }
          - { name: mcbscore-customer-search-index, branch: develop, group: standard, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-db-replica, branch: develop, group: standard, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-es-plugin-collection, branch: develop, group: standard, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-framework, branch: develop, group: standard, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-usageprices-ui, branch: develop, group: standard, workflows: "../check, build, ../encoding" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  zap:
    if: ${{ github.event.inputs.group == 'zap' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mcbscore-business-transaction-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-contract-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-fee-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-invoice-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-mark-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-network-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
          - { name: mcbscore-party-service, branch: develop, group: zap, workflows: "../check, build, ../encoding, postBuild" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  test:
    if: ${{ github.event.inputs.group == 'test' || github.event.inputs.group == 'ALL' }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repository:
          - { name: mcbscore-github-test-repo, branch: main, group: mslib, workflows: "../check, build, ../encoding, postBuild" }
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Distribute Workflows
        id: distributeWorkflows
        uses: ./.github/actions/distribute-workflows
        with:
          repositoryName: ${{ matrix.repository.name }}
          repositoryGroup: ${{ matrix.repository.group }}
          repositoryBranch: ${{ matrix.repository.branch }}
          workflows: ${{ matrix.repository.workflows }}
          awsAccessKeyId: ${{ secrets.AWS_ACCESS_KEY_ID }}
          awsSecretAccessKey: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
